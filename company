EMPLOYEE(SSN, NAME, ADDRESS, SEX, SALARY, SUPERSSN, DNO) 
DEPARTMENT(DNO, DNAME, MGRSSN, MGRSTARTDATE) 
DLOCATION(DNO,DLOC) 
PROJECT(PNO, PNAME, PLOCATION, DNO) 
WORKS_ON(SSN, PNO, HOURS)
  
Q1.a) Make a list of all project numbers for projects that involve an employee whose last name is ‘Scott’, either as a worker or as a manager of the department that Controls the project.
  SELECT DISTINCT P.PNO 
FROM PROJECT P, DEPARTMENTS D, EMPLOYEE E 
WHERE E.DNO = D.DNO 
  AND D.DNO = P.DNO 
  AND (E.LNAME = 'SCOTT' 
       OR D.MGRSSN IN (SELECT SSN FROM EMPLOYEE WHERE LNAME = 'SCOTT'));

Q2.b) Show the resulting salaries if every employee working on the ‘IoT’ project is Given a 10 percent raise.
  SELECT E.SSN, E.FNAME, E.LNAME, 1.1 * E.SALARY AS RAISEDSAL 
FROM EMPLOYEE E, PROJECT P, WORKS_ON W 
WHERE P.PNAME = 'IOT' 
  AND P.PNO = W.PNO 
  AND E.SSN = W.SSN;

Q3.c) Find the sum of the salaries of all employees of the ‘Accounts’ department, as well as the maximum salary, the minimum salary, and the average salary in this department
  SELECT SUM(SALARY) AS SUMSAL, 
       AVG(SALARY) AS AVGSAL, 
       MIN(SALARY) AS MINSAL, 
       MAX(SALARY) AS MAXSAL 
FROM EMPLOYEE E, DEPARTMENTS D 
WHERE E.DNO = D.DNO 
  AND D.DNAME = 'ACCOUNTS';


Q4.d) Retrieve the name of each employee who works on the entire projects controlled by department number 5.
  SELECT E.FNAME, E.LNAME 
FROM EMPLOYEE E 
WHERE NOT EXISTS (
  (SELECT PNO FROM PROJECT WHERE DNO = '5') 
  MINUS 
  (SELECT PNO FROM WORKS_ON WHERE E.SSN = SSN)
);

Q5.e) For each department that has more than five employees, retrieve the department number and the number of its employees who are making more than Rs. 6,00,000.
SELECT D.DNO, D.DNAME, E.FNAME, E.LNAME, COUNT(*) AS NOOFEMP 
FROM EMPLOYEE E, DEPARTMENTS D 
WHERE E.DNO = D.DNO 
  AND E.SALARY > 600000 
  AND D.DNO IN (
    SELECT E1.DNO 
    FROM EMPLOYEE E1 
    GROUP BY E1.DNO 
    HAVING COUNT(*) > 5
  ) 
GROUP BY D.DNO, D.DNAME, E.FNAME, E.LNAME;
